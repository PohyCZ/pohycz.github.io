<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Find Pix Words</title>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/boostrap.min.js"></script>
	<link rel="stylesheet" href="css/boostrap.min.css" />

	<script type="text/javascript">
		var words = [];
		var regex;

		var loaded = false;

		var wordSize;

		$.ajax({
			type: 'get',
			url: 'words/cs.txt',
			success: function(data) {
				words = data.toLowerCase().split('\n');
				debug('words: ' + words);
				loaded = true;
			}
		});

		function generateLetters() {
			wordSize = $('#wordSize').val().valueOf();

			var html = "";
			for(var i = 0; i < wordSize; i++) {
				html += "<input type=\"text\" id=\"" + i + "\" size=\"1\" placeholder=\"" + (i + 1) +"\">";
			}
			html += "<br />";

			debug('word size: ' + wordSize);

			$('.letters').html(html);
		}

		function getWord() {
			var word = [];
			for(var i = 0; i < wordSize; i++) {
				var value = $('#' + i).val().toLowerCase();
				if(value == '')
					word.push(' ');
				else
					word.push(value);
			}
			debug('word: ' + word);
			return word;
		}

		function debug(string) {
			// console.log('DEBUG: ' + string);
		}

		function getWords() {
			letters = $('#letters').val().toLowerCase().split('');
			debug('letters: ' + letters);

			word = getWord();

			var regexString = "";
			word.forEach(function(letter) {
				if(letter == ' ')
					regexString += '[' + letters + ']';
				else
					regexString += letter;
			});
			debug('regex: ' + regexString);
			regex = new RegExp(regexString, 'g');

			var matchedWords;
			if(loaded) {
				matchedWords = words.filter(function(element) {
					return regex.exec(element);
				});
				matchedWords = matchedWords.filter(function(element) {
					return element.length <= wordSize;
				});
			}
			debug('matched words: ' + matchedWords);

			var result = "";
			matchedWords.forEach(function(word) {
				result += word + "<br />";
			});
			// debug('result: ' + result);
			$('#result').html(result);
		}
	</script>
</head>
<body>
	<input type="text" id="wordSize" oninput="generateLetters()" />
	<div class="letters"></div>
	<input type="text" id="letters" placeholder="letters" oninput="getWords()" /><br>
	<input type="button" onclick="getWords()" value="Get words" /><br>
	<div id="result"></div>
</body>
</html>